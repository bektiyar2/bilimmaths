<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BilimMath ‚Äî Global Multilingual</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/5341/5341426.png">
    <meta name="theme-color" content="#5D5FEF">

    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        .math-card { box-shadow: 0 20px 60px rgba(93, 95, 239, 0.15); border-radius: 40px; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        .rank-gold { background: linear-gradient(45deg, #FFD700, #FFA500); color: white; }
    </style>
</head>
<body class="bg-[#F4F7FF] min-h-screen flex items-center justify-center p-4">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const firebaseConfig = {
            apiKey: "AIzaSyDYcopzuJzFYm2T0-GonGA4YQqpzz5egxw",
            authDomain: "bilimmath-a3e1e.firebaseapp.com",
            projectId: "bilimmath-a3e1e",
            storageBucket: "bilimmath-a3e1e.firebasestorage.app",
            messagingSenderId: "1016139764877",
            appId: "1:1016139764877:web:f9de05ef243efb41823ec4",
            databaseURL: "https://bilimmath-a3e1e-default-rtdb.europe-west1.firebasedatabase.app"
        };

        if (!firebase.apps.length) { firebase.initializeApp(firebaseConfig); }
        const db = firebase.database();

        const randomInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;
        
        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ù–û–î (GCD)
        const getGCD = (a, b) => (!b ? a : getGCD(b, a % b));
        
        const taskGenerators = {
            // 1 –ö–õ–ê–°–°: –ß–∏—Å–ª–∞ 0-20, –°–ª–æ–∂–µ–Ω–∏–µ/–í—ã—á–∏—Ç–∞–Ω–∏–µ, –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–µ–π—Å—Ç–≤–∏–π
            1: [
                { id: 'add20', kk: '“ö–æ—Å—É (20-“ì–∞ –¥–µ–π—ñ–Ω)', ru: '–°–ª–æ–∂–µ–Ω–∏–µ (–¥–æ 20)', gen: () => { const a=randomInt(1,10), b=randomInt(1,10); return { q: {kk:`${a} + ${b}`, ru:`${a} + ${b}`}, ans: a+b }; } },
                { id: 'sub20', kk: '–ê–∑–∞–π—Ç—É (20-“ì–∞ –¥–µ–π—ñ–Ω)', ru: '–í—ã—á–∏—Ç–∞–Ω–∏–µ (–¥–æ 20)', gen: () => { const a=randomInt(5,20), b=randomInt(1,a); return { q: {kk:`${a} - ${b}`, ru:`${a} - ${b}`}, ans: a-b }; } },
                { id: 'eq_simple', kk: '–¢–µ“£–¥–µ—É (x+a=b)', ru: '–£—Ä–∞–≤–Ω–µ–Ω–∏–µ (x+a=b)', gen: () => { const a=randomInt(1,10), ans=randomInt(1,10); return { q: {kk:`x + ${a} = ${ans+a}`, ru:`x + ${a} = ${ans+a}`}, ans: ans }; } }
            ],
            // 2 –ö–õ–ê–°–°: –ß–∏—Å–ª–∞ –¥–æ 100, –¢–∞–±–ª–∏—Ü–∞ —É–º–Ω–æ–∂–µ–Ω–∏—è, –°–∫–æ–±–∫–∏
            2: [
                { id: 'add100', kk: '“ö–æ—Å—É (100-–≥–µ –¥–µ–π—ñ–Ω)', ru: '–°–ª–æ–∂–µ–Ω–∏–µ (–¥–æ 100)', gen: () => { const a=randomInt(15,60), b=randomInt(15,39); return { q: {kk:`${a} + ${b}`, ru:`${a} + ${b}`}, ans: a+b }; } },
                { id: 'mult_tbl', kk: '–ö”©–±–µ–π—Ç—É –∫–µ—Å—Ç–µ—Å—ñ', ru: '–¢–∞–±–ª–∏—Ü–∞ —É–º–Ω–æ–∂–µ–Ω–∏—è', gen: () => { const a=randomInt(2,9), b=randomInt(2,9); return { q: {kk:`${a} ¬∑ ${b}`, ru:`${a} ¬∑ ${b}`}, ans: a*b }; } },
                { id: 'brackets', kk: '–ñ–∞“õ—à–∞–ª—ã ”©—Ä–Ω–µ–∫', ru: '–°–ª–æ–∂–µ–Ω–∏–µ —Å–æ —Å–∫–æ–±–∫–∞–º–∏', gen: () => { const a=randomInt(10,20), b=randomInt(5,10), c=randomInt(1,5); return { q: {kk:`${a} - (${b} - ${c})`, ru:`${a} - (${b} - ${c})`}, ans: a-(b-c) }; } }
            ],
            // 3 –ö–õ–ê–°–°: –í–Ω–µ—Ç–∞–±–ª–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ, –î–µ–ª–µ–Ω–∏–µ, –ü–µ—Ä–∏–º–µ—Ç—Ä
            3: [
                { id: 'div_simple', kk: '–ë”©–ª—É –∫–µ—Å—Ç–µ—Å—ñ', ru: '–î–µ–ª–µ–Ω–∏–µ', gen: () => { const b=randomInt(2,9), ans=randomInt(2,9); const a=b*ans; return { q: {kk:`${a} : ${b}`, ru:`${a} : ${b}`}, ans: ans }; } },
                { id: 'mult_big', kk: '10-“ì–∞, 100-–≥–µ –∫”©–±–µ–π—Ç—É', ru: '–£–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ 10, 100', gen: () => { const a=randomInt(2,9), zeros=randomInt(1,2); const mult = zeros===1?10:100; return { q: {kk:`${a} ¬∑ ${mult}`, ru:`${a} ¬∑ ${mult}`}, ans: a*mult }; } },
                { id: 'geom_p', kk: '–ü–µ—Ä–∏–º–µ—Ç—Ä (P)', ru: '–ü–µ—Ä–∏–º–µ—Ç—Ä (P)', gen: () => { const a=randomInt(2,10), b=randomInt(2,10); return { q: {kk:`–¢—ñ–∫ —Ç”©—Ä—Ç–±“±—Ä—ã—à: a=${a}, b=${b}. P=?`, ru:`–ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫: a=${a}, b=${b}. P=?`}, ans: (a+b)*2 }; } }
            ],
            // 4 –ö–õ–ê–°–°: –ú–Ω–æ–≥–æ–∑–Ω–∞—á–Ω—ã–µ —á–∏—Å–ª–∞, –°–∫–æ—Ä–æ—Å—Ç—å, –ü–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π
            4: [
                { id: 'calc_big', kk: '–ö”©–ø—Ç–∞“£–±–∞–ª—ã —Å–∞–Ω–¥–∞—Ä', ru: '–ú–Ω–æ–≥–æ–∑–Ω–∞—á–Ω—ã–µ —á–∏—Å–ª–∞', gen: () => { const a=randomInt(100,500), b=randomInt(100,500); return { q: {kk:`${a} + ${b}`, ru:`${a} + ${b}`}, ans: a+b }; } },
                { id: 'speed', kk: '“ö–æ–∑“ì–∞–ª—ã—Å (S=v¬∑t)', ru: '–î–≤–∏–∂–µ–Ω–∏–µ (S=v¬∑t)', gen: () => { const v=randomInt(40,90), t=randomInt(2,5); return { q: {kk:`v=${v}, t=${t}. S=?`, ru:`v=${v}, t=${t}. S=?`}, ans: v*t }; } },
                { id: 'ops_order', kk: '–ê–º–∞–ª–¥–∞—Ä —Ä–µ—Ç—ñ', ru: '–ü–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π', gen: () => { const a=randomInt(2,10), b=randomInt(2,5); return { q: {kk:`100 - ${a} ¬∑ ${b}`, ru:`100 - ${a} ¬∑ ${b}`}, ans: 100-(a*b) }; } }
            ],
            // 5 –ö–õ–ê–°–°: –î—Ä–æ–±–∏, –ù–û–î/–ù–û–ö, –°—Ç–µ–ø–µ–Ω–∏, –ü—Ä–æ—Ü–µ–Ω—Ç—ã
            5: [
                { id: 'pow2', kk: '–°–∞–Ω–Ω—ã“£ –∫–≤–∞–¥—Ä–∞—Ç—ã', ru: '–ö–≤–∞–¥—Ä–∞—Ç —á–∏—Å–ª–∞', gen: () => { const a=randomInt(2,15); return { q: {kk:`${a}¬≤`, ru:`${a}¬≤`}, ans: a*a }; } },
                { id: 'gcd', kk: '–ï“Æ–û–ë (–ù–û–î)', ru: '–ù–û–î (–ï“Æ–û–ë)', gen: () => { const c=randomInt(2,10), a=c*randomInt(1,5), b=c*randomInt(6,10); return { q: {kk:`–ï“Æ–û–ë(${a}, ${b})`, ru:`–ù–û–î(${a}, ${b})`}, ans: getGCD(a,b) }; } },
                { id: 'dec_add', kk: '–û–Ω–¥—ã“õ –±”©–ª—à–µ–∫—Ç–µ—Ä', ru: '–î–µ—Å—è—Ç–∏—á–Ω—ã–µ –¥—Ä–æ–±–∏', gen: () => { const a=randomInt(1,50), b=randomInt(1,50); return { q: {kk:`${a/10} + ${b/10}`, ru:`${a/10} + ${b/10}`}, ans: (a+b)/10 }; } },
                { id: 'perc', kk: '–ü–∞–π—ã–∑ (%)', ru: '–ü—Ä–æ—Ü–µ–Ω—Ç—ã (%)', gen: () => { const n=randomInt(1,20)*100; return { q: {kk:`${n}-–Ω—ã“£ 1%-—ã`, ru:`1% –æ—Ç ${n}`}, ans: n*0.01 }; } }
            ],
            // 6 –ö–õ–ê–°–°: –†–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —á–∏—Å–ª–∞ (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ), –ú–æ–¥—É–ª—å, –ü—Ä–æ–ø–æ—Ä—Ü–∏–∏
            6: [
                { id: 'neg_sum', kk: '–¢–µ—Ä—ñ—Å —Å–∞–Ω–¥–∞—Ä–¥—ã “õ–æ—Å—É', ru: '–°–ª–æ–∂. –æ—Ç—Ä–∏—Ü. —á–∏—Å–µ–ª', gen: () => { const a=randomInt(1,20), b=randomInt(1,20); return { q: {kk:`(-${a}) + (-${b})`, ru:`(-${a}) + (-${b})`}, ans: -(a+b) }; } },
                { id: 'abs_val', kk: '–ú–æ–¥—É–ª—å', ru: '–ú–æ–¥—É–ª—å', gen: () => { const a=randomInt(-50,-5); return { q: {kk:`|${a}| + 5`, ru:`|${a}| + 5`}, ans: Math.abs(a)+5 }; } },
                { id: 'prop_x', kk: '–ü—Ä–æ–ø–æ—Ä—Ü–∏—è', ru: '–ü—Ä–æ–ø–æ—Ä—Ü–∏—è', gen: () => { const x=randomInt(2,10); return { q: {kk:`x : 5 = ${x*3} : 15`, ru:`x : 5 = ${x*3} : 15`}, ans: x }; } },
                { id: 'int_mult', kk: '–¢–∞“£–±–∞–ª–∞—Ä –µ—Ä–µ–∂–µ—Å—ñ', ru: '–ü—Ä–∞–≤–∏–ª–æ –∑–Ω–∞–∫–æ–≤', gen: () => { const a=randomInt(2,10), b=randomInt(2,10); return { q: {kk:`(-${a}) ¬∑ ${b}`, ru:`(-${a}) ¬∑ ${b}`}, ans: -a*b }; } }
            ],
            // 7 –ö–õ–ê–°–°: –°—Ç–µ–ø–µ–Ω–∏, –§–°–£, –õ–∏–Ω–µ–π–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
            7: [
                { id: 'pow_prop', kk: '–î”ô—Ä–µ–∂–µ “õ–∞—Å–∏–µ—Ç—ñ', ru: '–°–≤–æ–π—Å—Ç–≤–∞ —Å—Ç–µ–ø–µ–Ω–µ–π', gen: () => { const n=randomInt(2,5); return { q: {kk:`(2¬≥)^${n} = 2^x`, ru:`(2¬≥)^${n} = 2^x`}, ans: 3*n }; } },
                { id: 'fsu_calc', kk: '“ö—ã—Å“õ–∞—à–∞ –∫”©–±–µ–π—Ç—É', ru: '–§–°–£ (–≤—ã—á–∏—Å–ª–µ–Ω–∏–µ)', gen: () => { const a=randomInt(10,20); return { q: {kk:`${a}¬≤ - ${a-1}¬≤`, ru:`${a}¬≤ - ${a-1}¬≤`}, ans: a*a - (a-1)*(a-1) }; } }, // a^2 - b^2
                { id: 'lin_func', kk: 'y=kx+b', ru: '–§—É–Ω–∫—Ü–∏—è y=kx+b', gen: () => { const k=randomInt(2,5), x=randomInt(1,5), b=randomInt(1,10); return { q: {kk:`y=${k}x+${b}, x=${x}. y=?`, ru:`y=${k}x+${b}, x=${x}. y=?`}, ans: k*x+b }; } }
            ],
            // 8 –ö–õ–ê–°–°: –ö–æ—Ä–Ω–∏, –ö–≤. —É—Ä–∞–≤–Ω–µ–Ω–∏—è (–î–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç, –í–∏–µ—Ç), –ü–∏—Ñ–∞–≥–æ—Ä
            8: [
                { id: 'sqrt_val', kk: '–¢“Ø–±—ñ—Ä–ª–µ—Ä', ru: '–ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å', gen: () => { const n=randomInt(2,20); return { q: {kk:`‚àö${n*n}`, ru:`‚àö${n*n}`}, ans: n }; } },
                { id: 'discr', kk: '–î–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç', ru: '–î–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç', gen: () => { const b=randomInt(4,9), c=randomInt(1,3); return { q: {kk:`x¬≤ + ${b}x + ${c} = 0. D=?`, ru:`x¬≤ + ${b}x + ${c} = 0. D=?`}, ans: b*b - 4*c }; } },
                { id: 'vieta', kk: '–í–∏–µ—Ç —Ç–µ–æ—Ä–µ–º–∞—Å—ã', ru: '–¢–µ–æ—Ä–µ–º–∞ –í–∏–µ—Ç–∞', gen: () => { const x1=randomInt(1,5), x2=randomInt(1,5); return { q: {kk:`x¬≤ - ${x1+x2}x + ${x1*x2} = 0. x‚ÇÅ+x‚ÇÇ=?`, ru:`x¬≤ - ${x1+x2}x + ${x1*x2} = 0. x‚ÇÅ+x‚ÇÇ=?`}, ans: x1+x2 }; } }
            ],
            // 9 –ö–õ–ê–°–°: –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–∏, –§–∞–∫—Ç–æ—Ä–∏–∞–ª, –¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è
            9: [
                { id: 'arith_prog', kk: '–ê—Ä–∏—Ñ–º. –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è', ru: '–ê—Ä–∏—Ñ–º. –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è', gen: () => { const a1=randomInt(1,10), d=randomInt(2,5); return { q: {kk:`a‚ÇÅ=${a1}, d=${d}. a‚ÇÉ=?`, ru:`a‚ÇÅ=${a1}, d=${d}. a‚ÇÉ=?`}, ans: a1+2*d }; } },
                { id: 'fact', kk: '–§–∞–∫—Ç–æ—Ä–∏–∞–ª', ru: '–§–∞–∫—Ç–æ—Ä–∏–∞–ª', gen: () => { const n=randomInt(3,5); const f = n===3?6:n===4?24:120; return { q: {kk:`${n}!`, ru:`${n}!`}, ans: f }; } },
                { id: 'trig', kk: '–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è', ru: '–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è', gen: () => { const deg = [30, 90, 180][randomInt(0,2)]; const ans = deg===30?1:deg===90?2:0; return { q: {kk:`2 ¬∑ sin(${deg}¬∞)`, ru:`2 ¬∑ sin(${deg}¬∞)`}, ans: deg===30?1:deg===90?2:0 }; } } // —É–ø—Ä–æ—â–µ–Ω–Ω–æ
            ]
        };
        const App = () => {
            const [lang, setLang] = useState('kk');
            const [user, setUser] = useState(localStorage.getItem('bilim_user') || '');
            const [tempName, setTempName] = useState('');
            const [grade, setGrade] = useState(1);
            const [topicId, setTopicId] = useState('all');
            const [problem, setProblem] = useState(null);
            const [answer, setAnswer] = useState('');
            const [isCorrect, setIsCorrect] = useState(null);
            const [leaders, setLeaders] = useState([]);
            const [showRank, setShowRank] = useState(false);
            const inputRef = useRef(null); // –†–µ—Ñ –¥–ª—è —Ñ–æ–∫—É—Å–∞

            useEffect(() => {
                const leadersRef = db.ref('users');
                leadersRef.on('value', (snap) => {
                    if (snap.exists()) {
                        const list = Object.values(snap.val()).sort((a, b) => b.score - a.score);
                        setLeaders(list);
                    }
                });
            }, []);

            const generate = (g = grade, tId = topicId) => {
                const topics = taskGenerators[g];
                let selected = tId === 'all' ? topics[randomInt(0, topics.length - 1)] : topics.find(x => x.id === tId);
                if (!selected) selected = topics[0];
                const data = selected.gen();
                setProblem({ ...data, topicName: {kk: selected.kk, ru: selected.ru} });
                setTimeout(() => inputRef.current?.focus(), 100); // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ–æ–∫—É—Å
            };

            useEffect(() => { if(user) generate(grade, 'all'); setTopicId('all'); }, [grade, user]);

            const check = () => {
                if (!answer || isCorrect !== null) return;
                const correct = parseFloat(answer) === problem.ans;
                setIsCorrect(correct);
                if (correct) {
                    db.ref('users/' + user).transaction(d => {
                        if (d) { d.score += 10; return d; }
                        return { name: user, score: 10 };
                    });
                }
                setTimeout(() => { generate(); setAnswer(''); setIsCorrect(null); }, 1300);
            };

            const t = {
                kk: { welcome: "–ï—Å—ñ–º—ñ“£–¥—ñ –∂–∞–∑:", start: "–ë–∞—Å—Ç–∞—É", rank: "–†–ï–ô–¢–ò–ù–ì", score: "“∞–ø–∞–π", check: "–¢–ï–ö–°–ï–†–£", yes: "–î“∞–†–´–°!", no: "“ö–ê–¢–ï!", all: "–ë–ê–†–õ–´“í–´" },
                ru: { welcome: "–í–≤–µ–¥–∏—Ç–µ –∏–º—è:", start: "–ù–∞—á–∞—Ç—å", rank: "–†–ï–ô–¢–ò–ù–ì", score: "–ë–∞–ª–ª—ã", check: "–ü–†–û–í–ï–†–ò–¢–¨", yes: "–í–ï–†–ù–û!", no: "–û–®–ò–ë–ö–ê!", all: "–í–°–ï –¢–ï–ú–´" }
            }[lang];

            if (!user) {
                return (
                    <div className="math-card bg-white w-full max-w-[400px] p-10">
                        <h1 className="text-3xl font-black text-[#5D5FEF] mb-6">BilimMath</h1>
                        <p className="text-gray-400 mb-4 text-sm font-bold uppercase tracking-widest">{t.welcome}</p>
                        <input value={tempName} onChange={e => setTempName(e.target.value)} className="w-full bg-gray-50 border-2 border-gray-100 rounded-2xl p-4 mb-4 outline-none focus:border-[#5D5FEF] font-bold text-lg" placeholder="..." />
                        <button onClick={() => { if(tempName.trim()){ setUser(tempName.trim()); localStorage.setItem('bilim_user', tempName.trim()); db.ref('users/'+tempName.trim()).once('value', s => { if(!s.exists()) db.ref('users/'+tempName.trim()).set({name: tempName.trim(), score: 0}); }); } }} className="w-full bg-[#5D5FEF] text-white py-4 rounded-2xl font-black shadow-lg"> {t.start} </button>
                    </div>
                );
            }

            if (showRank) {
                return (
                    <div className="math-card bg-white w-full max-w-[400px] p-8 h-[550px] flex flex-col">
                        <div className="flex justify-between items-center mb-6 text-gray-800">
                            <h2 className="text-2xl font-black italic">üèÜ {t.rank}</h2>
                            <button onClick={() => setShowRank(false)} className="text-[#5D5FEF] font-bold text-sm uppercase">–ù–∞–∑–∞–¥</button>
                        </div>
                        <div className="flex-1 overflow-y-auto no-scrollbar">
                            {leaders.map((p, i) => (
                                <div key={i} className={`flex justify-between items-center p-4 rounded-2xl mb-2 ${p.name === user ? 'bg-indigo-50 border border-indigo-100' : 'bg-gray-50'}`}>
                                    <div className="flex items-center gap-3">
                                        <span className={`w-8 h-8 flex items-center justify-center rounded-full font-black text-xs ${i === 0 ? 'rank-gold' : 'bg-gray-200'}`}>{i+1}</span>
                                        <span className="font-bold text-gray-700">{p.name}</span>
                                    </div>
                                    <span className="font-black text-[#5D5FEF]">{p.score}</span>
                                </div>
                            ))}
                        </div>
                    </div>
                );
            }

            return (
                <div className="math-card bg-white w-full max-w-[480px] p-8">
                    <div className="flex justify-between items-center mb-8">
                        <div>
                            <h1 className="text-[#5D5FEF] text-xl font-black">BilimMath <span className="text-[10px] text-gray-300 ml-1">KZ</span></h1>
                            <p className="text-[10px] font-bold text-gray-400 uppercase tracking-tighter italic">{user}</p>
                        </div>
                        <div className="flex gap-2">
                             <button onClick={() => setShowRank(true)} className="bg-gray-50 px-3 py-2 rounded-xl text-[10px] font-black text-[#5D5FEF] border border-gray-100 uppercase tracking-widest">{t.rank}</button>
                             <div className="flex bg-gray-50 p-1 rounded-xl text-[10px] font-bold border border-gray-100">
                                <button onClick={() => setLang('kk')} className={`px-2 py-1 rounded-lg ${lang === 'kk' ? 'bg-white text-[#5D5FEF] shadow-sm' : 'text-gray-300'}`}>KK</button>
                                <button onClick={() => setLang('ru')} className={`px-2 py-1 rounded-lg ${lang === 'ru' ? 'bg-white text-[#5D5FEF] shadow-sm' : 'text-gray-300'}`}>RU</button>
                            </div>
                        </div>
                    </div>

                    <div className="grid grid-cols-5 gap-2 mb-6">
                        {[1,2,3,4,5,6,7,8,9].map(g => (
                            <button key={g} onClick={() => setGrade(g)} className={`py-3 rounded-2xl font-black text-xs transition ${grade === g ? 'bg-[#5D5FEF] text-white shadow-lg' : 'bg-[#F2F6FF] text-[#5D5FEF]'}`}>{g}</button>
                        ))}
                    </div>

                    <div className="flex gap-2 overflow-x-auto no-scrollbar mb-6 pb-1">
                        <button onClick={() => {setTopicId('all'); generate(grade, 'all');}} className={`px-4 py-2 rounded-full text-[10px] font-black tracking-wider whitespace-nowrap transition ${topicId === 'all' ? 'bg-[#5D5FEF] text-white' : 'bg-gray-50 text-gray-400'}`}>{t.all}</button>
                        {taskGenerators[grade].map(topic => (
                            <button key={topic.id} onClick={() => {setTopicId(topic.id); generate(grade, topic.id);}} className={`px-4 py-2 rounded-full text-[10px] font-black tracking-wider whitespace-nowrap transition ${topicId === topic.id ? 'bg-[#5D5FEF] text-white' : 'bg-gray-50 text-gray-400'}`}>{topic[lang].toUpperCase()}</button>
                        ))}
                    </div>

                    <div className="bg-[#F9FBFF] rounded-[40px] p-10 text-center mb-6 border border-indigo-50/50">
                        <p className="text-[#A5B4FC] font-black tracking-[0.2em] text-[9px] mb-3 uppercase">{problem?.topicName[lang]}</p>
                        <h2 className="text-4xl font-black text-[#2D3142]">{problem?.q[lang]} = ?</h2>
                    </div>

                    <input ref={inputRef} type="number" inputMode="decimal" value={answer} onChange={e => setAnswer(e.target.value)} onKeyDown={e => e.key === 'Enter' && check()} className="w-full bg-[#F2F6FF] rounded-[24px] py-6 text-center text-4xl font-black text-[#5D5FEF] mb-6 outline-none border-4 border-transparent focus:border-indigo-100 transition-all placeholder:text-indigo-100" placeholder="?" />

                    <button onClick={check} disabled={isCorrect !== null} className={`w-full py-6 rounded-[24px] text-white font-black text-xl shadow-xl transition-all active:scale-95 ${isCorrect === true ? 'bg-green-500' : isCorrect === false ? 'bg-red-500' : 'bg-[#5D5FEF]'}`}>
                        {isCorrect === true ? t.yes : isCorrect === false ? t.no : t.check}
                    </button>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

        // –®–ê–ì 3: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker –¥–ª—è PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js').catch(err => console.log('SW error:', err));
            });
        }
    </script>
</body>
</html>


